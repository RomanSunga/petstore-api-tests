name: Allure Report
on: [push]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with: 
          python-version: '3.9'
      - run: pip install requests pytest allure-pytest
      - run: |
          mkdir -p tests
          cat > tests/test_simple.py << 'EOF'
          import requests
          def test_api():
              r = requests.get('https://petstore.swagger.io/v2/pet/findByStatus?status=available')
              assert r.status_code == 200
          EOF
          pytest tests/ --alluredir=allure-results
      - uses: simple-elf/allure-report-action@master
        with:
          allure_results: allure-results
          allure_report: allure-report
